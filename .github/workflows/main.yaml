# Copyright (c) 2020 Yoann MOUGNIBAS
# 
# This file is part of MusicWorkflow.
# 
# MusicWorkflow is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# 
# MusicWorkflow is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with MusicWorkflow.  If not, see <https://www.gnu.org/licenses/>.

#
# Reference : https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-syntax-for-github-actions
#

# The name of the workflow.
name: Default continuous integration

# This C.I. will only run on pull requests targeting "master" and "feature/*" branches.
# No C.I. will run on push on branches if they are not under a P.R. workflow.
on:
  pull_request:
    branches:
      - master
      - feature/*

jobs:

  # This windows build will run the following commands on solution :
  # - 'dotnet restore'
  # - 'dotnet build --configuration Release'
  # - 'dotnet test  --configuration Release --logger trx'
  windows-build:

    # Use a "Windows Server 2019" runner (Microsoft based).
    runs-on: windows-2019

    # Use a classic "checkout/restore/build/test" workflow.
    steps:

      # Use this action to checkout the current git repository.
      # Default value use "${{ github.repository }}" as repository
      # and the event SHA-1 as ref.
      # Reference documentation : https://github.com/marketplace/actions/checkout
      - uses: actions/checkout@v2

      # Restore the solution.
      - name: dotnet_restore
        run:  dotnet restore

      # Build the solution.
      - name: dotnet_build
        run:  dotnet build --configuration 'Release'

      # Test the solution.
      - name: dotnet_test
        run:  dotnet test --configuration 'Release' --logger trx
